---
title: "TFA-003"
date: 2023-09-11 20:00:00 +0800
status: To Do
draft: false
tags:
  - IaC
  - Terraform
---
## Infrastructure as Code (IaC) Concepts
---
### What is IaC?
클라우드 인프라를 구성할 때 대부분은 AWS Console 과 같은 UI 를 통해 리소스를 생성하게 되는데 이는 아래와 같은 단점들을 가져온다.
- Human Error 를 통한 Misconfiguration
- 운영중인 리소스의 상태를 관리하기가 어려워짐

Infrastructure as Code (IaC) 는 클라우드 인프라를 수동으로 관리할 때 발생하는 위와 같은 문제점을 인프라를 코드로 관리함으로써 해결해준다. 한 마디로 IaC 는 인프라의 blueprint 와 같은 역할을 하는 것.

### Declarative vs Imperative
IaC 툴은 크게 선언형 도구와 명령형 도구로 구분되는데, AWS CloudFormation 등 선언형 도구는 JSON, YAML 과 같은 스크립트 언어로 작성되고, AWS CDK, Pulumi 등 명령형 도구는 Python 등 프로그래밍 언어로 작성된다.

Terraform 은 선언형과 명령형 그 중간 정도에 해당하는 HCL 로 작성하는데 Loop, Dynamic Blocks, Locals, Maps, Collections 등을 지원한다.

### Mutable vs Immutable Infrastructure
VM 을 예로, Mutable Infrastructure 는 클라우드 인프라가 배포된 후 Ansible 등 Provisioning 도구를 통해 설정하여 사용한다. Immutable Infrastructure 는 클라우드 인프라를 Packer 등의 도구를 통해 VM 을 Provisioning 한 상태를 이미지로 만들어 저장하고 이렇게 생성된 이미지를 통해 인프라를 배포하는 방식이다. 즉, Immutable Infrastructure 는 말 그대로 불변 상태로 배포되는 것.

## Terraform Basics
---
### Terraform Lifecycle
1. Code - Terraform 파일을 HCL 로 작성
2. init - Terraform project 를 initialize 하고 latest provider 와 module 을 불러옴
3. plan - 작성된 Terraform 파일을 토대로 변경될 사항을 미리 계획
4. validate - 작성된 Terraform 파일이 제대로 작성되었는지 확인
5. apply - 작성된 Terraform 파일을 토대로 실제 인프라를 생성
6. destroy - 생성된 인프라를 제거

### 


## 3. Understand Terraform basics
---
### 3.1. Install and version Terraform providers

### 3.2. Describe plugin-based architecture

### 3.3. Write Terraform configuration using multiple providers

### 3.4. Describe how Terraform finds and fetches providers

## 4. Use Terraform outside the core workflow
---
### 4.1. Describe when to use Terraform import to import existing infrastructure into your Terraform state

### 4.2. Use Terraform state to view Terraform state

### 4.3. Describe when to enable verbose logging and what the outcome/value is

## 5. Interact with Terraform modules
---
### 5.1. Contrast and use different module source options including the public Terraform Registry

### 5.2. 

## 6. Use the core Terraform workflow
---
## 7. Implement and maintain state
---
## 8. Read, generate, and modify configuration
---
## 9. Understand Terraform Cloud capabilities
---
